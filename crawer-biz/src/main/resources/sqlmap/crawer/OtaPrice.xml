<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mk.crawer.biz.mapper.crawer.OtaPriceMapper" >
  <resultMap id="BaseResultMap" type="com.mk.crawer.biz.model.crawer.OtaPrice" >
    <result column="ots_hotel_name" property="otsHotelName" />
    <result column="ex_hotel_id" property="exHotelId" />
    <result column="ots_room_type_id" property="otsRoomTypeId" />
    <result column="ex_room_type_id" property="exRoomTypeId" />
    <result column="room_type_id" property="roomTypeId" />
    <result column="room_type_key" property="roomTypeKey" />
    <result column="hotel_id" property="hotelId" />
    <result column="hotel_source_id" property="hotelSourceId" />
    <result column="price" property="price" />
    <result column="o_price" property="oprice" />
    <result column="real_price" property="realPrice" />
    <result column="origin_price" property="originPrice" />
    <result column="show_price" property="showPrice" />
    <result column="ota_show_price" property="otaShowPrice" />
    <result column="wrapper_name" property="wrapperName" />
    <result column="wrapper_id" property="wrapperId" />
    <result column="all_room_count" property="allRoomCount" />
    <result column="available_roomcount" property="availableRoomcount" />
  </resultMap>

  <sql id="Base_Column_List" >
    ex_hotel_id,ots_room_type_id,ex_room_type_id,room_type_id,room_type_key,hotel_id,
    hotel_source_id,price,o_price,real_price,origin_price,show_price,ota_show_price,wrapper_name,
    wrapper_id,all_room_count,available_roomcount
  </sql>
  <sql id="Base_Query_List" >
    <where>
      <if test="exHotelId != null">
        ex_hotel_id = #{exHotelId}
      </if>
      <if test="otsRoomTypeId != null">
        AND ots_room_type_id = #{otsRoomTypeId}
      </if>
      <if test="exRoomTypeId != null">
        AND ex_room_type_id  = #{exRoomTypeId}
      </if>
      <if test="roomTypeId != null">
        AND room_type_id  = #{roomTypeId}
      </if>
      <if test="roomTypeKey != null">
        AND room_type_key  = #{roomTypeKey}
      </if>
      <if test="hotelId != null">
        AND hotel_id  = #{hotelId}
      </if>
      <if test="hotelSourceId != null">
        AND hotel_source_id  = #{hotelSourceId}
      </if>
      <if test="exRoomTypeId != null">
        AND ex_room_type_id  = #{exRoomTypeId}
      </if>
      <if test="exRoomTypeId != null">
        AND ex_room_type_id  = #{exRoomTypeId}
      </if>
      <if test="exRoomTypeId != null">
        AND ex_room_type_id  = #{exRoomTypeId}
      </if>

    </where>
  </sql>
  <select id="getOtaPrice" resultMap="BaseResultMap" parameterType="com.mk.crawer.biz.model.crawer.OtaPrice" >
  select
    <include refid="Base_Column_List" />
  from cps_user a  LEFT  JOIN cps_channel b on a.channelId=b.id
    <include refid="Base_Column_List" />
  </select>

</mapper>